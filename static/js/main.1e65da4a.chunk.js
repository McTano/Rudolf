(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{74:function(e,t,n){e.exports=n(96)},76:function(e,t,n){},96:function(e,t,n){"use strict";n.r(t);n(75),n(76);var a=n(0),r=n.n(a),o=n(7),i=n.n(o),c=n(53),u=n(21),s=n(14),l=n(121),f=n(122),d=n(123),m=n(56),p=n(57),h=n(67),v=n(66),w=n(44),b=n(58),E=function(e){var t=e.formulas,n=void 0===t?[]:t,a=e.forest;return{nodeType:"formulas",formulas:n,forest:void 0===a?[]:a,id:e.id}},y=function e(t,n){"contradiction"!==t.nodeType&&("finished"!==t.nodeType?0===t.forest.length?t.forest=n(t.id):t.forest.forEach((function(t){return e(t,n)})):console.warn("shouldn't try to append to finished branch"))},g=function(e){return E({formulas:e.map((function(e,t){return k(e,t+1)})),forest:[],id:""})},k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return{value:e,resolved:!1,row:t}},j=function(e){return null!=e&&"formulas"===e.nodeType&&0===e.forest.length},S=function(e){return O(e)+e.formulas.length},O=function(e){return e.formulas[0].row},C=function(e,t){for(var n=[];e-- >0;)n.push(k("",t++));return n},x=function(e,t){var n,a=function(e){return e.split("").map((function(t){if("0"===t||"1"===t)return Number(t);throw new Error("invalid character in node id: ".concat(t," in ").concat(e))}))}(t),r=e,o=Object(b.a)(a);try{for(o.s();!(n=o.n()).done;){var i=n.value;if("formulas"!==r.nodeType)throw new Error("Failed to get node path");r=r.forest[i]}}catch(c){o.e(c)}finally{o.f()}return r},R=function(e){return"formulas"===e.nodeType},N=function(e){Object(h.a)(n,e);var t=Object(v.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"updateFormula",value:function(e,t,n){x(this.draftState.tree,e).formulas[t].value=n}},{key:"updateJustification",value:function(e,t){Object.assign(this.draftState.justifications[e],t)}},{key:"updateContradiction",value:function(e,t){Object.assign(x(this.draftState.tree,e),{contradictoryRows:t})}},{key:"updateFeedback",value:function(e){this.draftState.feedback=e}},{key:"toggleResolved",value:function(e,t){var n=x(this.draftState.tree,e);n.formulas[t].resolved=!n.formulas[t].resolved}},{key:"createTree",value:function(e){this.draftState.tree=g(e),this.draftState.nextRow=e.length+1,this.draftState.justifications={1:{rule:"",parentRow:""}}}},{key:"continueBranch",value:function(e,t){var n=this,a=x(this.draftState.tree,e);y(a,(function(e){return[E({id:"".concat(e,"0"),formulas:C(t,n.draftState.nextRow)})]})),this.draftState.justifications[this.draftState.nextRow]={rule:"",parentRow:""},this.draftState.nextRow+=t}},{key:"splitBranch",value:function(e,t){var n=this,a=x(this.draftState.tree,e);y(a,(function(e){var a=C(t,n.draftState.nextRow);return[E({id:"".concat(e,"0"),formulas:a}),E({id:"".concat(e,"1"),formulas:a})]})),this.draftState.justifications[this.draftState.nextRow]={rule:"",parentRow:""},this.draftState.nextRow+=t}},{key:"markContradiction",value:function(e){var t,n=x(this.draftState.tree,e);n.forest=[(t=n.id,{nodeType:"contradiction",formulas:[],contradictoryRows:"",id:"".concat(t,"0")})]}},{key:"markFinished",value:function(e){var t;x(this.draftState.tree,e).forest=[(t=e,{nodeType:"finished",formulas:[],id:"".concat(t,"0")})]}},{key:"reopenBranch",value:function(e){x(this.draftState.tree,e).forest=[]}},{key:"updateWindowSize",value:function(){this.draftState.windowSize="".concat(window.innerHeight,"x").concat(window.innerWidth)}}]),n}(w.ImmerReducer),T="P->Q,P,~Q".split(","),P={tree:g(T),nextRow:T.length+1,justifications:{1:{rule:"AS",parentRow:""}},feedback:{errorMessage:"Nothing yet."},windowSize:"".concat(window.innerHeight,"x").concat(window.innerWidth)},z=Object(w.createReducerFunction)(N),B=Object(w.createActionCreators)(N),A=B.continueBranch,M=B.createTree,F=B.markContradiction,D=B.markFinished,Q=B.reopenBranch,W=B.splitBranch,I=B.toggleResolved,J=B.updateContradiction,L=B.updateFeedback,q=B.updateFormula,H=B.updateJustification,U=B.updateWindowSize,G=n(50),X=n(116),$=n(65),K=Object($.a)({Bounder:{minWidth:"100%",position:"fixed",bottom:0,display:"flex",flexDirection:"column",zIndex:10},TextArea:{overflow:"hidden scroll",fontSize:"16px"},Toggle:{backgroundColor:"black",color:"white",fontSize:"13px",alignSelf:"flex-end","&:hover":{cursor:"pointer"},padding:"2px 10px"}}),V=n(43),Y=n(35),Z=n.n(Y),_=n(52),ee=function e(t,n){var a=t.formulas,r=t.forest,o=t.id,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],c=i.concat(a);if(0===r.length)return{label:oe(c),rule:"",forest:[],id:o};var l=Object(s.a)(r,1),f=l[0];if("formulas"===f.nodeType){var d=n[O(f)],m=d.rule,p=Number(d.parentRow);if(!ie(p))throw new Error('Cited row must be a positive integer. Got "'.concat(p,'"'));if(p>=O(f))throw new Error("Row cited (".concat(p,") must be less than current row (").concat(O(f),")."));return{label:oe(c),rule:"St",forest:[{label:re(c,p),rule:m,id:o,forest:r.map((function(t){return e(t,n,c.filter((function(e){return!(e.row===p)})))}))}]}}if("contradiction"===f.nodeType){var h=f.contradictoryRows.split(",").map(Number),v=Object(s.a)(h,2),w=v[0],b=v[1];if(![w,b].every(ie))throw new Error('Contradiction must cite 2 rows, separated by a comma. Got "'.concat(f.contradictoryRows,'"'));var E=c.filter((function(e){return[w,b].includes(e.row)})).sort((function(e,t){return t.value.length-e.value.length})),y=Object(s.a)(E,2),g=y[0],k=y[1];if(!g||!k)throw new Error("Contradiction cites non-existent row");var j=oe([g].concat(Object(u.a)(c.filter((function(e){return![w,b].includes(e.row)}))),[k]));return{label:oe(c),rule:"St",id:o,forest:[{label:j,rule:"Ax",id:f.id,forest:[{label:"",rule:"",forest:[]}]}]}}if("finished"===f.nodeType)return{label:oe(c),rule:"St",id:o,forest:[{label:oe(c),rule:"Lit",id:f.id,forest:[{label:"",rule:"",forest:[]}]}]};throw new Error("this was supposed to be exhaustive")},te=function(e,t){var n={};if(e.forest.length){!function e(t,a,r){if("string"===typeof t.id){if("Ax"===t.rule||"Lit"===t.rule)return void(n[t.id]=ce(a));n[t.id]=r,t.forest.forEach((function(t,n){e(t,a.forest[n],ce(a))}))}else t.forest.forEach((function(t,n){e(t,a.forest[n],r)}))}(e,t,{class:"correct",info:"Assumptions"})}return n},ne=function(){var e=Object(_.a)(Z.a.mark((function e(t){return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){try{Carnap.checkIchikawaJenkinsSLTableau(t,(function(t){e(t)}))}catch(a){n(a)}})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ae=function(){var e=Object(_.a)(Z.a.mark((function e(t,n){var a,r;return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=ee(t,n),e.next=3,ne(a);case 3:return r=e.sent,e.abrupt("return",{sequent:a,feedback:te(a,r)});case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),re=function(e,t){var n=e.findIndex((function(e){return e.row===t})),a=e[n],r=e.slice(0,n).concat(e.slice(n+1)),o=[].concat(Object(u.a)(r),[a]);return oe(o)},oe=function(e){return e.map((function(e){return e.value})).join(",").concat(":|-:")},ie=function(e){return e>0},ce=function(e){e.forest;return Object(V.a)(e,["forest"])},ue=function(e){var t=e.tree,n=e.justifications,o=e.feedback,i=e.dispatch;Object(a.useEffect)((function(){window.Carnap&&ae(t,n).then((function(e){var t=e.sequent,n=e.feedback;return i(L({feedback:n,sequent:t}))})).catch((function(e){var t=e.message;return i(L({errorMessage:t}))}))}),[i,n,t]);var c=K(),u=Object(a.useState)(!1),l=Object(s.a)(u,2),f=l[0],d=l[1];return r.a.createElement("div",{className:c.Bounder},r.a.createElement("div",{className:c.Toggle,onClick:function(){d(!f)}},f?"close":"open"),r.a.createElement(X.a,{className:c.TextArea,value:JSON.stringify({tree:t,justifications:n,feedback:o}),style:{maxHeight:f?"50vh":"0vh"}}))},se=n(125),le=n(23),fe=n.n(le),de=n(60),me=n.n(de),pe=n(120),he=n(124),ve=n(127),we=function(e){var t=e.open,n=e.dispatch,a=e.index,o=e.anchorEl,i=e.onClose,c=e.node,u=c.formulas[a];return r.a.createElement(he.a,{open:t,anchorEl:o,onClose:i},r.a.createElement(ve.a,{onClick:function(){n(A(c.id,1)),i()}},"Continue Branch w/ 1 formula"),r.a.createElement(ve.a,{onClick:function(){n(W(c.id,1)),i()}},"Split Branch w/ 1 formula"),r.a.createElement(ve.a,{onClick:function(){n(A(c.id,2)),i()}},"Continue Branch w/ 2 formulas"),r.a.createElement(ve.a,{onClick:function(){n(W(c.id,2)),i()}},"Split Branch w/ 2 formulas"),r.a.createElement(ve.a,{onClick:function(){n(I(c.id,a)),i()}},"Mark as ",u.resolved?"Un":"","Resolved"),j(c)&&r.a.createElement(ve.a,{onClick:function(){n(F(c.id)),i()}},"Close Branch With Contradiction"),j(c)&&r.a.createElement(ve.a,{onClick:function(){n(D(c.id)),i()}},"Mark Branch Finished"),"contradiction"===c.nodeType&&r.a.createElement(ve.a,{onClick:function(){n(Q(c.id)),i()}},"Reopen Branch"))},be=function(e){var t=e.index,n=e.row,o=e.dispatch,i=e.node,c=i.formulas[t],u=c.value,l=c.resolved,f=Object(a.useState)(!1),d=Object(s.a)(f,2),m=d[0],p=d[1],h=Object(a.useRef)(null);return r.a.createElement("div",{className:"formula",ref:h,onContextMenu:function(e){e.preventDefault(),p(!0)}},r.a.createElement("span",null,n),r.a.createElement(fe.a,{className:"label",onChange:function(e){return o(q(i.id,t,e.currentTarget.value))},value:u,placeholder:"formula"}),r.a.createElement(we,{open:m,onClose:function(){return p(!1)},dispatch:o,anchorEl:h.current,index:t,node:i}),l?r.a.createElement(pe.a,null):"")},Ee=function(e){for(var t=e.diff,n=[],a=t;n.length<a;)n.push(r.a.createElement("div",{className:"spacer",key:a}));return(r.a.createElement("div",{className:"spacers-".concat(t)},n))},ye=function e(t){var n,o,i=t.node,c=t.dispatch,u=t.justifications,s=t.feedbackMap,l=t.windowSize,f=Object(V.a)(t,["node","dispatch","justifications","feedbackMap","windowSize"]);if(s){var d,m=null!==(d=s[i.id])&&void 0!==d?d:"";n=m.info,o="correct"===m.class?"correct":"incorrect"}else n="",o="";if(R(i)){var p,h=i.id,v=i.formulas,w=i.forest,b="formulas"===(null===(p=w[0])||void 0===p?void 0:p.nodeType)?r.a.createElement(Ee,{diff:O(w[0])-S(i)}):void 0,E=u[O(i)],y=E.rule,g=E.parentRow;return r.a.createElement("div",{className:"node-container "},r.a.createElement(se.a,{title:n,PopperProps:{style:{fontSize:16}}},r.a.createElement("div",Object.assign({className:"node node-id=".concat(h," ").concat(o)},f),v.map((function(e,t){return r.a.createElement(be,Object.assign({key:"".concat(e,"-").concat(t),node:i,index:t,dispatch:c},e))})),""!==i.id?r.a.createElement("div",{className:"justification"},r.a.createElement(fe.a,{className:"rule",onChange:function(e){var t=e.currentTarget.value;return c(H(O(i),{rule:t}))},value:y,placeholder:"rule"}),r.a.createElement(fe.a,{className:"row",onChange:function(e){var t=e.currentTarget.value;return c(H(O(i),{parentRow:t}))},value:g,placeholder:"row"})):"AS")),r.a.createElement("div",{className:"children ".concat(w.length>1?"split":"stack")},w.map((function(t){return r.a.createElement(a.Fragment,{key:t.id},b,r.a.createElement(me.a,{key:l,from:"node-id=".concat(h),to:"node-id=".concat(t.id),borderColor:"black",fromAnchor:"bottom",toAnchor:"top",delay:0}),r.a.createElement(e,{node:t,dispatch:c,justifications:u,feedbackMap:s,windowSize:l}))}))))}if("contradiction"===i.nodeType)return r.a.createElement(se.a,{title:n,PopperProps:{style:{fontSize:16}}},r.a.createElement("div",Object.assign({className:"closed-branch-marker node ".concat(o)},f),"X",r.a.createElement(fe.a,{className:"rule",onChange:function(e){var t=e.currentTarget.value;return c(J(i.id,t))},value:i.contradictoryRows,placeholder:"rows"})));if("finished"===i.nodeType)return r.a.createElement(se.a,{title:n,PopperProps:{style:{fontSize:16}}},r.a.createElement("div",Object.assign({className:"finished-branch-marker ".concat(o)},f),"O"," "));throw new Error("Invariant violation: Invalid nodeType on node: ".concat(JSON.stringify(i)))},ge=function(e){var t=e.onSubmit,n=e.premises,a=e.setPremises;return r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t(n)}},r.a.createElement(fe.a,{type:"text",name:"premises","aria-label":"Enter Premises",value:n,onChange:function(e){return a(e.target.value)}}),r.a.createElement("button",{className:"submit-premises",type:"submit"},"Declare Premises"))},ke=[["P->Q,P,~Q","Modus Ponens"],["~(~(P\\/Q)<->(~P/\\~Q))","De Morgen's Law"]],je=function(e){var t=e.onChange;return r.a.createElement("select",{onChange:function(e){var n=e.currentTarget.value;t(n)}},ke.map((function(e){var t=Object(s.a)(e,2),n=t[0],a=t[1];return(r.a.createElement("option",{value:n,key:n},a))})))},Se=function(){var e,t=Object(a.useState)("P->Q,P,~Q"),n=Object(s.a)(t,2),o=n[0],i=n[1],m=a.useReducer.apply(void 0,Object(u.a)((e=z,[function(t,n){var a=Object(s.a)(t,3),r=a[0],o=a[1],i=a[2];switch(n.type){case"UNDO":var c=Object(G.a)(r),l=c[0];return[c.slice(1),l,[o].concat(Object(u.a)(i))];case"REDO":var f=Object(G.a)(i),d=f[0],m=f.slice(1);return[[o].concat(Object(u.a)(r)),d,m];default:return[[o].concat(Object(u.a)(r)),e(o,n),[]]}},[[],P,[]]]))),p=Object(s.a)(m,2),h=Object(s.a)(p[0],3),v=h[0],w=h[1],b=h[2],E=p[1];Object(a.useEffect)((function(){var e=function(){E(U())};return window.onresize=e,function(){(window.onresize=e)&&(window.onresize=null)}}),[]);var y=function(e){i(e);var t=e.split(",");E(M(t))};return(r.a.createElement("main",{className:"App"},r.a.createElement(je,{onChange:y}),r.a.createElement(ge,{premises:o,onSubmit:y,setPremises:i}),r.a.createElement("span",{className:"tree-buttons"},r.a.createElement(l.a,{className:"undo-button",onClick:function(){E({type:"UNDO"})},disabled:!v.length},r.a.createElement(f.a,null)),r.a.createElement(l.a,{className:"redo-button",onClick:function(){E({type:"REDO"})},disabled:!b.length},r.a.createElement(d.a,null))),r.a.createElement(ye,{node:w.tree,dispatch:E,justifications:w.justifications,feedbackMap:w.feedback.feedback,windowSize:w.windowSize}),r.a.createElement(ue,Object(c.a)(Object(c.a)({},w),{},{dispatch:E}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(Se,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[74,1,2]]]);
//# sourceMappingURL=main.1e65da4a.chunk.js.map